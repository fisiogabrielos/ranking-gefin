<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ranking GEFIN - Salto Vertical (Super Mario Edition)</title>
  <style>
    /* Importa fonte pixelizada */
    @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&family=VT323&display=swap');

    :root {
      --mario-sky: #6B8CFF;
      --mario-brick: #A13A0E;
      --mario-qblock: #E9C46A;
      --mario-coin: #FFD700;
      --mario-pipe: #008000;
      --text-color: #fff;
    }

    body {
      font-family: 'VT323', monospace;
      background-color: var(--mario-sky);
      /* Imagens embutidas para o fundo do Mario (c√©u e ch√£o) */
      background-image: 
        url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAAgCAYAAAD198enAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAADISURBVHhe7cwxAQAADMOg+TfdycgDHrgJ5wACAAgAIAAACAAgAIAAAAAACAAgAIAAACAAgAAAAAAIAAACAAgAIAAACAAgAAAAAAIAAACAAgAIAAACAAAAAAACAAgAIAAACAAgAIAAAAAACAAgAIAAACAAgAAAAAAIAAACAAgAIAAACAAAAAAACAAgAIAAACAAgAIAAAAAACAAgAIAAACAAgAAAAAAIAAACAAgAIAAACAAAAAAACAAgAIAAACAAgAIAAAAAACAAgAIAAACAAgAAAAAAIAAACAAgAIAAACAAAAAAAArwDx1gABfr/N0AAAAABJRU5ErkJggg=='),
        url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAAgCAYAAAD198enAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAFRSURBVHhe7dJBEsQwCAPBCfk/d7cIIZpA2Lq7W1AChAAAQggAIYQACCEAQggAIYQACCEAQggAIYQACCEAQggAIYQACCEAQggAIYQACCEAQggAIYQACCEAQggAIYQACCEAQggAIYQACCEAQggAIYQACCEAQggAIYQACCEAQgjBlzHm3b5d2Y5t29b0s/3s1iMAQgjBlzHm3b5d2Y5t29b0s/3s1iMAQgjBlzHm3b5d2Y5t29b0s/3s1iMAQgjBlzHm3b5d2Y5t29b0s/3s1iMAQgjBlzHm3b5d2Y5t29b0s/3s1iMAQgjBlzHm3b5d2Y5t29b0s/3s1iMAQgjBlzHm3b5d2Y5t29b0s/3s1iMAQgjBlzHm3b5d2Y5t29b0s/3s1iMAQgjBlzHm3b5d2Y5t29b0s/3s1iMAQggAIYQACCEAQggAIYQACCEAQggAIYQACCEAQggAIYQACCEAQggAIYQACCEAQggAIYQACCEAQggAIYQACCEAQggAIYQACCEAQggAIYQACCEAQggAIYQACCEAQggAIYQACCEAQggAIYQACCED+5gE23EYkU6l0mAAAAABJRU5ErkJggg==');
      background-repeat: repeat-x, repeat-x;
      background-position: top 20px, bottom;
      background-size: auto, 100% 150px;
      color: var(--text-color);
      text-align: center;
      padding: 20px 5%;
      overflow-x: hidden;
      position: relative;
    }

    h1 {
      font-family: 'Press Start 2P', cursive;
      color: #fff;
      text-shadow: 3px 3px #000;
      margin-bottom: 30px;
      font-size: clamp(1.8rem, 5vw, 2.5rem);
      animation: title-bounce 1s infinite alternate;
      padding: 15px;
      border: 5px solid #000;
      background-color: var(--mario-brick);
      display: inline-block;
      box-shadow: 0 8px 0 #000;
    }

    @keyframes title-bounce {
      from { transform: translateY(0px); }
      to { transform: translateY(-10px); }
    }

    #loading-message {
      font-size: clamp(1.2rem, 4vw, 1.8rem);
      color: #fff;
      text-shadow: 2px 2px #000;
      margin-bottom: 30px;
      animation: blink-mario 1s infinite steps(1);
    }
    
    @keyframes blink-mario {
      0% { opacity: 1; }
      50% { opacity: 0; }
    }
    
    table {
      margin: 40px auto;
      width: 100%;
      max-width: 900px;
      background: rgba(0, 0, 0, 0.7);
      border: 5px solid #000;
      box-shadow: 0 8px 0 #000;
      visibility: hidden;
      opacity: 0;
      transition: opacity 1s ease-in-out;
    }
    
    table.loaded {
      visibility: visible;
      opacity: 1;
    }

    th, td {
      padding: 15px;
      border: 3px solid #000;
      font-size: 1.2rem;
      text-shadow: 2px 2px #000;
    }

    th {
      background: var(--mario-pipe);
      color: #fff;
    }

    tbody tr:hover {
      background-color: var(--mario-qblock);
      color: #000;
      cursor: pointer;
    }

    .top1 { background: var(--mario-star) !important; color: #000; font-size: 1.4rem; font-weight: bold; }
    .top2 { background: var(--mario-mushroom) !important; color: #fff; font-size: 1.3rem; font-weight: bold; }
    .top3 { background: var(--mario-fireflower) !important; color: #fff; font-size: 1.2rem; font-weight: bold; }

    .medal {
      font-size: 1.8rem;
      animation: medal-spin 1.5s linear infinite;
      display: inline-block;
    }

    @keyframes medal-spin {
      from { transform: rotateY(0deg); }
      to { transform: rotateY(360deg); }
    }
    
    #hero {
      width: 48px;
      height: 64px;
      /* Imagem do Mario embutida */
      background: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMAAAAAgCAYAAAD0eI4jAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAHySURBVHhe7dJNKwRRFAbg/+9+lwghIgmFkGhIKGkhIWRDIbFQyAb5A1JISCFRyEJCkjdIssF/yGYjP4qEbEOh5e7s6p7pGvA5s3tmt2f/zJk5s3t3d3eP5/f7L/N8Ph8LAIA/4/P5fPz+AQAAvs7n8/ECAAB/yufz8QIAAABAAAAAAAAAAAAAAAAAAAAAAAAA/yK63ySAcuuLKCwzPst3dEA5Y1WpTtViT8ICb2Z4l+8eQDEKDeVWeYhX5GZ4lu8eQI0sN5Vr5CYg8xOW4Vu+ewB1srJSrRbyEpSZgV+9+e4BFCvLhXwtp/wEpcxQz/I9AChWlgO5hTwhLwEBM8zzPQEoVpYKuVZOPIFfBpgYnucbgLJSrRZyjJzkE/gqQJTB8z0BKKuLhXwhL/EJTDDM8z0BKCvdQp4QH/EEZpjlex9QrCwX8kO8xCdQxPB9D6BY6S7kC/EJnGB4vucBxUq/kAfEJzABDM/3PKBYKZdyjfgEJiDm+Z4HVCvLhXwhLuITWJjh+Z4HVCvlQu4Ql/gENsxwPAQAyq1cKxdxj7jEJfAQAChXloP4jbjEJ/ADAEBllQt5Q1ziEpSA+R4AFCvdQ1ziEpSA+R4AFCvdQ1ziEpSA+R4AFL1/AH5L6BHF2bcoAAAAAElFTkSuQmCC') 0 0;
      position: fixed;
      bottom: 85px;
      left: 0;
      animation: hero-run 0.5s steps(4) infinite, hero-move 15s linear infinite;
      z-index: 100;
      image-rendering: pixelated;
    }

    @keyframes hero-run {
      from { background-position: 0 0; }
      to { background-position: -192px 0; }
    }

    @keyframes hero-move {
      0% { transform: translateX(-50px); }
      100% { transform: translateX(100vw); }
    }
    
    #hero.jump {
      animation: hero-jump 0.5s steps(1) 1, hero-move 15s linear infinite;
      background-position: -192px 0; /* Frame do pulo */
    }

    @keyframes hero-jump {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-100px); }
    }
    
    @media (max-width: 768px) {
      body {
          padding: 10px;
          background-size: auto, 100% 120px;
      }
      h1 { font-size: 1.5rem; }
      table { width: 95%; }
      td, th { padding: 10px; font-size: 1rem; }
      #hero { bottom: 65px; }
    }
  </style>
</head>
<body>
  
  <h1>‚≠ê Ranking GEFIN - Salto Vertical üçÑ</h1>
  
  <p id="loading-message">PRESS START</p>
  
  <table id="ranking">
    <thead>
      <tr>
        <th>Posi√ß√£o</th>
        <th>Nomes</th>
        <th>Altura (cm)</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <div id="hero"></div>

  <audio id="start-sound" src="https://actions.google.com/sounds/v1/games/game_start.ogg" preload="auto"></audio>
  <audio id="coin-sound" src="https://actions.google.com/sounds/v1/arcade_games/coin_collect.ogg" preload="auto"></audio>
  <audio id="powerup-sound" src="https://actions.google.com/sounds/v1/arcade_games/power_up.ogg" preload="auto"></audio>
  <audio id="hover-sound" src="https://actions.google.com/sounds/v1/sports/swoosh_and_jump.ogg" preload="auto"></audio>

  <script>
    const publicSpreadsheetUrl = 
      "https://docs.google.com/spreadsheets/d/e/2PACX-1vQ1PFABZm_ON5E8_cMwlbVu6MZcHFAyyptjHNae4PYXkPVq4rBfd1-T0O1opyxn50M_krEEIo1MSec2/pub?output=csv";

    async function loadRankingData() {
      document.getElementById('start-sound').play().catch(e => {});

      try {
        const response = await fetch(publicSpreadsheetUrl);
        const csvText = await response.text();
        const data = parseCSV(csvText);
        
        document.getElementById('loading-message').style.display = 'none';
        
        await showInfo(data);
        document.getElementById('ranking').classList.add('loaded');

      } catch (error) {
        console.error("Falha ao carregar ranking:", error);
        const loadingMessage = document.getElementById('loading-message');
        loadingMessage.textContent = "GAME OVER";
      }
    }

    function parseCSV(text) {
      const lines = text.trim().split('\n');
      if (lines.length < 2) return [];
      const headers = lines[0].split(',').map(header => header.trim());
      return lines.slice(1).map(line => {
        const values = line.split(',').map(value => value.trim());
        let entry = {};
        headers.forEach((header, index) => {
          entry[header] = values[index] || '';
        });
        return entry;
      }).filter(item => item.Nomes && item["Altura m√°xima (cm)"]);
    }
    
    async function showInfo(data) {
      data.sort((a, b) => parseFloat(b["Altura m√°xima (cm)"]) - parseFloat(a["Altura m√°xima (cm)"]));
      const tbody = document.querySelector("#ranking tbody");
      tbody.innerHTML = "";
      const hoverSound = document.getElementById("hover-sound");

      for (const [index, item] of data.entries()) {
        await new Promise(r => setTimeout(r, 200));
        document.getElementById("coin-sound").play().catch(e => {});

        const row = document.createElement("tr");
        
        let medal = "";
        if(index === 0) { 
            row.classList.add("top1"); 
            medal = "‚≠ê"; 
            document.getElementById("powerup-sound").play().catch(e => {});
            const hero = document.getElementById('hero');
            hero.classList.add('jump');
            setTimeout(() => hero.classList.remove('jump'), 500);
        }
        else if(index === 1) { row.classList.add("top2"); medal = "üçÑ"; }
        else if(index === 2) { row.classList.add("top3"); medal = "üå∏"; } // Flor de fogo
        
        row.innerHTML = `
          <td>${index + 1}¬∫ <span class="medal">${medal}</span></td>
          <td>${item.Nomes}</td> 
          <td>${item["Altura m√°xima (cm)"]}</td>
        `;
        
        row.addEventListener('mouseover', () => {
          hoverSound.currentTime = 0;
          hoverSound.play().catch(e => {});
        });
        
        tbody.appendChild(row);
      }
    }

    window.addEventListener("DOMContentLoaded", loadRankingData);
  </script>

</body>
</html>
