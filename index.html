<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Ranking GEFIN - Arcade Turbo Edition!</title>
  <style>
    @import url('https://fonts.googleapis.comcom/css2?family=Press+Start+2P&display=swap');

    :root {
      --arcade-yellow: #ffcc00;
      --arcade-red: #ff0066;
      --arcade-blue: #00ffff;
    }

    body {
      font-family: 'Press Start 2P', cursive;
      background: #0a0a0a;
      color: #fff;
      text-align: center;
      padding: 20px;
      overflow-x: hidden;
    }

    h1 {
      color: var(--arcade-yellow);
      text-shadow: 3px 3px var(--arcade-red);
      margin-bottom: 30px;
      font-size: 24px;
      animation: title-blink 1.5s infinite alternate;
    }

    @keyframes title-blink {
      from { opacity: 1; }
      to { opacity: 0.8; }
    }

    table {
      margin: 0 auto;
      border-collapse: collapse;
      width: 80%;
      background: #000000d0;
      box-shadow: 0 0 20px var(--arcade-yellow), 0 0 30px var(--arcade-red);
      border: 5px solid var(--arcade-yellow);
      animation: table-entry 1s ease-out forwards;
      backdrop-filter: blur(2px);
    }

    @keyframes table-entry {
      from { opacity: 0; transform: translateY(50px); }
      to { opacity: 1; transform: translateY(0); }
    }

    th, td {
      padding: 15px;
      border: 2px solid var(--arcade-yellow);
      font-size: 15px;
      text-shadow: 1px 1px #000;
    }

    th {
      background: var(--arcade-red);
      color: #fff;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    tr:nth-child(even) { background: #111111d0; }
    tr:nth-child(odd) { background: #222222d0; }

    .top1 {
      background: #ffd700 !important;
      color: #000;
      font-size: 18px;
      font-weight: bold;
      animation: top1-glow 1.5s infinite alternate;
    }

    @keyframes top1-glow {
      from { box-shadow: 0 0 10px #ffd700; }
      to { box-shadow: 0 0 20px #ffd700, 0 0 30px var(--arcade-red); }
    }

    .top2 { background: #c0c0c0 !important; color: #000; font-size: 16px; font-weight: bold; }
    .top3 { background: #cd7f32 !important; color: #000; font-size: 16px; font-weight: bold; }

    .medal {
      font-size: 22px;
      animation: medal-pulse 1s infinite alternate;
      display: inline-block;
    }

    @keyframes medal-pulse {
      from { transform: scale(1); }
      to { transform: scale(1.1); }
    }

    .footer-arcade {
        margin-top: 40px;
        color: var(--arcade-blue);
        text-shadow: 1px 1px #000;
        font-size: 18px;
        animation: footer-blink 2s infinite alternate;
    }

    @keyframes footer-blink {
        from { opacity: 1; }
        to { opacity: 0.5; }
    }
  </style>
</head>
<body>
  <h1>üèÜ Ranking GEFIN ‚Äì Salto Vertical üïπÔ∏è</h1>
  
  <table id="ranking">
    <thead>
      <tr>
        <th>Posi√ß√£o</th>
        <th>Nomes</th>
        <th>Altura m√°xima (cm)</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <p class="footer-arcade">Ready Player One?</p>

  <audio id="coin" src="https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg" preload="auto"></audio>
  <audio id="levelup" src="https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg" preload="auto"></audio>

  <script>
    const publicSpreadsheetUrl = 
      "https://docs.google.com/spreadsheets/d/e/2PACX-1vQ1PFABZm_ON5E8_cMwlbVu6MZcHFAyyptjHNae4PYXkPVq4rBfd1-T0O1opyxn50M_krEEIo1MSec2/pub?output=csv";

    async function loadRankingData() {
      try {
        const response = await fetch(publicSpreadsheetUrl);
        if (!response.ok) {
          throw new Error('Erro ao buscar os dados da planilha.');
        }
        const csvText = await response.text();
        const data = parseCSV(csvText);
        showInfo(data);
      } catch (error) {
        console.error("Falha ao carregar o ranking:", error);
        const tbody = document.querySelector("#ranking tbody");
        tbody.innerHTML = '<tr><td colspan="3">N√£o foi poss√≠vel carregar os dados. Verifique a planilha e o console (F12).</td></tr>';
      }
    }

    function parseCSV(text) {
      const lines = text.trim().split('\n');
      if (lines.length < 2) return []; // Retorna vazio se n√£o tiver dados
      const headers = lines[0].split(',').map(header => header.trim());
      return lines.slice(1).map(line => {
        const values = line.split(',').map(value => value.trim());
        let entry = {};
        headers.forEach((header, index) => {
          entry[header] = values[index] || ''; // Garante que n√£o seja undefined
        });
        return entry;
      });
    }
    
    // Vers√£o simplificada e mais segura da fun√ß√£o de exibi√ß√£o
    function showInfo(data) {
      document.getElementById("coin").play().catch(e => {});

      data.sort((a, b) => parseFloat(b["Altura m√°xima (cm)"]) - parseFloat(a["Altura m√°xima (cm)"]));

      const tbody = document.querySelector("#ranking tbody");
      tbody.innerHTML = "";

      data.forEach((item, index) => {
        const row = document.createElement("tr");
        let medal = "";
        if(index === 0) { row.classList.add("top1"); medal = "ü•á"; playLevelUp(); }
        else if(index === 1) { row.classList.add("top2"); medal = "ü•à"; }
        else if(index === 2) { row.classList.add("top3"); medal = "ü•â"; }
        
        row.innerHTML = `
          <td>${index + 1}¬∫ <span class="medal">${medal}</span></td>
          <td>${item.Nomes}</td> 
          <td>${item["Altura m√°xima (cm)"]}</td>
        `;
        tbody.appendChild(row);
      });
    }

    function playLevelUp() {
      const sound = document.getElementById("levelup");
      sound.currentTime = 0;
      sound.play().catch(e => {});
    }

    window.addEventListener("DOMContentLoaded", loadRankingData);
  </script>
</body>
</html>
